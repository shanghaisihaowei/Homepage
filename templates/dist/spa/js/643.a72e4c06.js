"use strict";(self["webpackChunktemplates"]=self["webpackChunktemplates"]||[]).push([[643],{3242:(e,o,t)=>{t.r(o),t.d(o,{default:()=>Q});var s=t(3673),l=t(2323),i=t(8880);const n=e=>((0,s.dD)("data-v-9bd6822a"),e=e(),(0,s.Cn)(),e),a={class:"text-h6 q-mb-sm"},r={class:"text-body2",style:{color:"#999999"}},d={class:"text-h6 q-mb-sm"},u={class:"text-h6 q-mb-sm"},m={class:"text-h6 q-mb-sm"},h={class:"text-h6 q-mb-sm"},p={style:{color:"#999999"}},_={class:"flex"},c=n((()=>(0,s._)("div",{class:"bg-grey-3 text-body1",style:{width:"70px",height:"40px","line-height":"40px","text-align":"center",color:"#999999","margin-left":"-12px"}}," V: ",-1))),g={class:"text-body2",style:{color:"#999999"}},w={class:"text-h6 q-mb-sm"},y={class:"text-h6 q-mb-sm"},v={class:"text-h6 q-mb-sm"},f={style:{"margin-left":"-8.5px"},class:"q-mt-sm"},b={class:"text-h6 q-mb-sm"},V={class:"q-mt-md flex"},$={class:"text-body2 text-black q-mr-sm"},x={class:"text-body2 text-black"},P={style:{color:"#d95555"},class:"q-my-md"};function W(e,o,t,n,W,q){const N=(0,s.up)("q-btn"),k=(0,s.up)("q-card"),z=(0,s.up)("q-select"),F=(0,s.up)("q-card-section"),M=(0,s.up)("q-input"),U=(0,s.up)("markdown-aditor"),T=(0,s.up)("upload-file"),D=(0,s.up)("q-radio");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(k,{square:"",flat:"",style:{color:"#999999"},class:"bottom_border q-py-md"},{default:(0,s.w5)((()=>[(0,s.Wm)(N,{class:"text-body1",onClick:o[0]||(o[0]=e=>this.$router.go(-1)),flat:""},{default:(0,s.w5)((()=>[(0,s.Uk)(" <"+(0,l.zw)(e.$t("community.e_shop_view.back")),1)])),_:1})])),_:1}),(0,s.Wm)(k,{square:"",flat:""},{default:(0,s.w5)((()=>[(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s._)("div",a,(0,l.zw)(e.$t("community.e_shop_view.affiliation"))+"： ",1),(0,s.Wm)(z,{style:{width:"100%"},dense:"",disable:"newPlugin"!=this.pluginId,outlined:"",modelValue:e.pluginBelonging,"onUpdate:modelValue":o[1]||(o[1]=o=>e.pluginBelonging=o),options:e.belongingOptions},(0,s.Nv)({_:2},[e.pluginBelonging?void 0:{name:"prepend",fn:(0,s.w5)((()=>[(0,s._)("div",r,(0,l.zw)(e.$t("community.e_shop_view.select"))+"： ",1)]))}]),1032,["disable","modelValue","options"])])),_:1}),(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s._)("div",d,(0,l.zw)(e.$t("community.e_shop_view.plugin_name"))+"： ",1),(0,s.Wm)(M,{style:{"padding-bottom":"0"},maxlength:"40","error-message":e.errorMessage_name,error:e.error_name,dense:"",outlined:"",modelValue:e.pluginName,"onUpdate:modelValue":o[2]||(o[2]=o=>e.pluginName=o),onFocus:o[3]||(o[3]=o=>e.hidePlaceholder("showNamePholder")),onBlur:o[4]||(o[4]=o=>e.showPlaceholder("pluginName","showNamePholder"))},{default:(0,s.w5)((()=>[(0,s.wy)((0,s._)("div",{class:"input_placeholder"},(0,l.zw)(e.$t("community.e_shop_view.placeholder_name")),513),[[i.F8,e.showNamePholder]])])),_:1},8,["error-message","error","modelValue"])])),_:1}),(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s._)("div",u,(0,l.zw)(e.$t("community.e_shop_view.plugin_tag"))+": ",1),(0,s.Wm)(M,{dense:"",outlined:"",modelValue:e.pluginTag,"onUpdate:modelValue":o[5]||(o[5]=o=>e.pluginTag=o),onFocus:o[6]||(o[6]=o=>e.hidePlaceholder("showTagPholder")),onBlur:o[7]||(o[7]=o=>e.showPlaceholder("pluginTag","showTagPholder"))},{default:(0,s.w5)((()=>[(0,s.wy)((0,s._)("div",{class:"input_placeholder"},(0,l.zw)(e.$t("community.e_shop_view.placeholder_tag")),513),[[i.F8,e.showTagPholder]])])),_:1},8,["modelValue"])])),_:1}),(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s._)("div",m,(0,l.zw)(e.$t("community.e_shop_view.plugin_des"))+": ",1),(0,s.Wm)(M,{dense:"",outlined:"",maxlength:"100","error-message":e.errorMessage_des,error:e.error_des,modelValue:e.pluginDes,"onUpdate:modelValue":o[8]||(o[8]=o=>e.pluginDes=o),onFocus:o[9]||(o[9]=o=>e.hidePlaceholder("showDesPholder")),onBlur:o[10]||(o[10]=o=>e.showPlaceholder("pluginDes","showDesPholder"))},{default:(0,s.w5)((()=>[(0,s.wy)((0,s._)("div",{class:"input_placeholder"},(0,l.zw)(e.$t("community.e_shop_view.placeholder_des")),513),[[i.F8,e.showDesPholder]])])),_:1},8,["error-message","error","modelValue"])])),_:1}),(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s._)("div",h,[(0,s.Uk)((0,l.zw)(e.$t("community.e_shop_view.plugin_versions"))+"：",1),(0,s._)("span",p,(0,l.zw)(e.$t("community.e_shop_view.example")),1)]),(0,s._)("div",_,[(0,s.Wm)(M,{style:{flex:"1"},modelValue:e.pluginVersions,"onUpdate:modelValue":o[11]||(o[11]=o=>e.pluginVersions=o),outlined:"",dense:"",onFocus:o[12]||(o[12]=e=>this.showVersionsPholder=!1),onBlur:o[13]||(o[13]=e=>{this.pluginVersions||(this.showVersionsPholder=!0)})},{prepend:(0,s.w5)((()=>[c])),default:(0,s.w5)((()=>[(0,s.wy)((0,s._)("div",{style:{"line-height":"40px",height:"40px",position:"absolute",left:"0px",cursor:"text",color:"#999999"}},(0,l.zw)(e.$t("community.e_shop_view.placeholder_versions")),513),[[i.F8,e.showVersionsPholder]])])),_:1},8,["modelValue"]),(0,s.Wm)(z,{style:{width:"200px"},class:"q-ml-md",dense:"",outlined:"",modelValue:e.versionsType,"onUpdate:modelValue":o[14]||(o[14]=o=>e.versionsType=o),options:e.versionsOptions},{prepend:(0,s.w5)((()=>[(0,s._)("div",g,(0,l.zw)(e.$t("community.e_shop_view.versions_type"))+"： ",1)])),_:1},8,["modelValue","options"])])])),_:1}),(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s._)("div",w,(0,l.zw)(e.$t("community.e_shop_view.update_explain"))+" ： ",1),(0,s.Wm)(U,{placeholder:e.placeholder_update,onGetMarkdownHtml:o[15]||(o[15]=o=>e.getMarkdownHtml("updateNotes",o))},null,8,["placeholder"])])),_:1}),(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s._)("div",y,(0,l.zw)(e.$t("community.e_shop_view.plugin_introduce"))+"： ",1),(0,s.Wm)(U,{placeholder:e.placeholder_use,onGetMarkdownHtml:o[16]||(o[16]=o=>e.getMarkdownHtml("useNotes",o))},null,8,["placeholder"])])),_:1}),(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s.Wm)(T,{onGetUploadFile:e.getUploadFile},null,8,["onGetUploadFile"])])),_:1}),(0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s._)("div",v,(0,l.zw)(e.$t("community.e_shop_view.release_method"))+"： ",1),(0,s._)("div",f,[(0,s.Wm)(D,{size:"sm",modelValue:e.radio_button,"onUpdate:modelValue":o[17]||(o[17]=o=>e.radio_button=o),val:"free",label:this.$t("community.e_shop_view.sort_free")},null,8,["modelValue","label"]),(0,s.Wm)(D,{class:"q-mx-lg",size:"sm",modelValue:e.radio_button,"onUpdate:modelValue":o[18]||(o[18]=o=>e.radio_button=o),val:"pay",label:this.$t("community.e_shop_view.sort_pay")},null,8,["modelValue","label"])])])),_:1}),(0,s.wy)((0,s.Wm)(F,null,{default:(0,s.w5)((()=>[(0,s._)("div",b,(0,l.zw)(e.$t("community.e_shop_view.software_cost"))+"： ",1),(0,s._)("div",V,[(0,s.Wm)(z,{outlined:"",dense:"",modelValue:e.paymentMethod,"onUpdate:modelValue":o[19]||(o[19]=o=>e.paymentMethod=o),options:e.paymentOptions,class:"payment_method"},{prepend:(0,s.w5)((()=>[(0,s._)("div",$,(0,l.zw)(e.$t("community.e_shop_view.money_type"))+" ： ",1)])),_:1},8,["modelValue","options"]),(0,s.Wm)(M,{modelValue:e.money,"onUpdate:modelValue":o[20]||(o[20]=o=>e.money=o),type:"number",outlined:"",dense:"",error:e.error_amount,"error-message":e.amountError,onBlur:e.moneyBlur,style:{"margin-left":"15px",flex:"1"}},{prepend:(0,s.w5)((()=>[(0,s._)("div",x,(0,l.zw)(e.$t("community.e_shop_view.label_fill_amount"))+" ： ",1)])),_:1},8,["modelValue","error","error-message","onBlur"])]),(0,s._)("div",P,(0,l.zw)(e.$t("community.e_shop_view.deduction_prompt")),1)])),_:1},512),[[i.F8,"pay"==e.radio_button]]),(0,s.Wm)(F,{class:"text-center",style:{"padding-bottom":"50px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(N,{class:(0,l.C_)(e.disable_release?"release_btn_disabled":"release_btn_undisabled"),unelevated:"",disable:e.disable_release,onClick:e.release},{default:(0,s.w5)((()=>[(0,s.Uk)((0,l.zw)(e.$t("community.e_shop_view.release")),1)])),_:1},8,["class","disable","onClick"])])),_:1})])),_:1})])}t(5363);var q=t(5474),N=t(5330),k=t(975);const z=(0,s.aZ)({components:{UploadFile:N.Z,MarkdownAditor:k.Z},data(){return{pluginName:"",pluginTag:"",pluginDes:"",pluginVersions:"",updateNotes:"",useNotes:"",radio_button:"free",paymentMethod:"",money:0,isFilled:!1,paymentOptions:["￥","$"],showUpdatePholder:!0,showUsePholder:!0,showNamePholder:!0,showTagPholder:!0,showVersionsPholder:!0,showDesPholder:!0,versionsType:"",versionsOptions:[this.$t("community.e_shop_view.official_version"),this.$t("community.e_shop_view.beta_version")],pluginBelonging:"",belongingOptions:[this.$t("community.greaterwms"),this.$t("community.dvadmin")],placeholder_update:`<div style='color:#999999'>${this.$t("community.e_shop_view.placeholder_update")}</div>`,placeholder_use:`<div style='color:#999999'>${this.$t("community.e_shop_view.placeholder_use")}</div>`,error_name:!1,errorMessage_name:this.$t("community.e_shop_view.maxlength_40_name"),error_des:!1,errorMessage_des:this.$t("community.e_shop_view.maxlength_100_des"),file:"",pluginId:"",error_amount:!1,amountError:this.$t("community.myAccount_view.money_tip")}},computed:{pluginMsg(){return{affiliation:this.pluginBelonging,tab_name:this.pluginTag,name:this.pluginName,brief:this.pluginDes,version:this.pluginVersions,versionsType:this.versionsType,plugin_instructions:this.updateNotes,direction_for_use:this.useNotes,source_code_file:this.file,release_form:"free"==this.radio_button?"0":"1",total_amount:this.money,currency:this.paymentMethod}},disable_release(){for(let e in this.pluginMsg)if(this.pluginMsg[e])this.isFilled=!0;else{if("total_amount"!=e&&"currency"!=e){this.isFilled=!1;break}if("free"!==this.radio_button){this.isFilled=!1;break}this.isFilled=!0}return!(this.isFilled&&!this.error_name&&!this.error_des)}},watch:{pluginName(e){40==e.length?this.error_name=!0:this.error_name=!1,e&&this.hidePlaceholder("showNamePholder")},pluginDes(e){100==e.length?this.error_des=!0:this.error_des=!1,e&&this.hidePlaceholder("showDesPholder")},pluginVersions(e){e&&this.hidePlaceholder("showVersionsPholder"),this.pluginVersions=e.replace(/[^\d^\.]+/g,"")},pluginTag(e){e&&this.hidePlaceholder("showTagPholder")}},methods:{moneyBlur(){this.money<.01?(this.error_amount=!0,this.money=0):this.error_amount=!1},hidePlaceholder(e){this[e]=!1},showPlaceholder(e,o){this[e]||(this[o]=!0)},release(){if("pay"==this.radio_button&&this.money<.01)this.error_amount=!0,this.money=0;else{this.error_amount=!1;let e=this.setUploadFormData();(0,q.postauth)("software/api/v1/add/",e).then((e=>{this.$q.notify({message:this.$t("community.myAccount_view.release_success"),icon:"check",color:"green"}),this.$router.push("/community/myReleasedPlugins")})).catch((e=>{console.log(e)}))}},getUploadFile(e){this.file=e},getMarkdownHtml(e,o){this[e]=o},setUploadFormData(){let e,o=new FormData;return o.append("affiliation",this.pluginBelonging==this.$t("community.dvadmin")?1:0),o.append("tab_name",this.pluginTag),o.append("brief",this.pluginDes),o.append("name",this.pluginName),o.append("version",`V${this.pluginVersions}`),o.append("version_type",this.versionsType),o.append("plugin_instructions",this.updateNotes),o.append("direction_for_use",this.useNotes),o.append("source_code_file",this.file),o.append("release_form","free"==this.radio_button?"0":"1"),e="$"==this.paymentMethod?"1":"0",0==e?o.append("rnb",this.money):o.append("dollar",this.money),o.append("currency",e),o},getMyPluginInfo(){(0,q.getauth)(`software/api/v1/my_soft/${this.pluginId}/`).then((e=>{this.pluginBelonging=0==e.affiliation?"GreateWMS":"DVAdmin",this.pluginName=e.name,this.pluginDes=e.brief,this.pluginVersions=e.versions[0].version,this.versionsType=e.versions[0].version_type,this.updateNotes=e.versions[0].plugin_instructions,this.useNotes=e.direction_for_use,this.radio_button=0==e.release_form?"free":"pay",1==e.release_form&&(this.paymentMethod=0==e.currency?"￥":"$",e.dollar?this.money=e.dollar:this.money=e.rnb),e.tab.forEach((e=>{this.pluginTag=this.pluginTag+e.tab_name+","}))}))}},created(){this.pluginId=this.$route.params.id,"newPlugin"!=this.pluginId&&this.getMyPluginInfo()}});var F=t(4260),M=t(151),U=t(2165),T=t(5589),D=t(9396),B=t(4842),Z=t(7991),C=t(7518),I=t.n(C);const O=(0,F.Z)(z,[["render",W],["__scopeId","data-v-9bd6822a"]]),Q=O;I()(z,"components",{QCard:M.Z,QBtn:U.Z,QCardSection:T.Z,QSelect:D.Z,QInput:B.Z,QRadio:Z.Z})}}]);