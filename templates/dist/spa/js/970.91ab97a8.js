"use strict";(self["webpackChunktemplates"]=self["webpackChunktemplates"]||[]).push([[970],{970:(t,e,i)=>{i.r(e),i.d(e,{default:()=>X});var a=i(3673),s=i(2323),r=i(8880);const n=t=>((0,a.dD)("data-v-4eaf76bf"),t=t(),(0,a.Cn)(),t),o={style:{color:"#333333","font-size":"16px"}},m=n((()=>(0,a._)("div",{class:"progress_number_active progress_number"},[(0,a._)("div",{class:"number"},"1")],-1))),l=["src"],u=n((()=>(0,a._)("div",{class:"number"},"2",-1))),c=[u],d={key:0},_={key:1},h=["src"],g=n((()=>(0,a._)("div",{class:"number"},"3",-1))),p=[g],f={class:"form_info"},b={key:1},v={class:"form_info"},w={key:1},y={class:"flex",style:{"align-items":"center"}},k={class:"form_info"},x={class:"flex"},D={class:"q-mt-md",style:{"font-size":"14px",color:"#999999","margin-left":"120px"}};function $(t,e,i,n,u,g){const $=(0,a.up)("q-card-section"),S=(0,a.up)("q-input"),z=(0,a.up)("upload-img"),q=(0,a.up)("q-btn"),C=(0,a.up)("q-card");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(C,{flat:"",class:"bottom_border"},{default:(0,a.w5)((()=>[(0,a.Wm)($,{class:"q-py-none bottom_border",style:{"font-size":"18px",height:"60px","line-height":"60px","font-weight":"500"}},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t.$t("community.authentication_view.authentication")),1)])),_:1}),(0,a.Wm)($,{class:"progress flex q-my-md",style:{"justify-content":"center"}},{default:(0,a.w5)((()=>[(0,a._)("div",null,[m,(0,a._)("div",null,(0,s.zw)(t.$t("community.authentication_view.fill_info")),1)]),(0,a._)("img",{style:{"margin-top":"-22px"},src:g.lingSrc[0]},null,8,l),(0,a._)("div",null,[(0,a._)("div",{class:(0,s.C_)(1==u.status||2==u.status?"progress_number_active progress_number":"progress_number"),style:(0,s.j5)(3==u.status?{backgroundColor:"#C80808"}:{})},c,6),3!=u.status?((0,a.wg)(),(0,a.iD)("div",d,(0,s.zw)(t.$t("community.authentication_view.auditing")),1)):(0,a.kq)("",!0),3==u.status?((0,a.wg)(),(0,a.iD)("div",_,(0,s.zw)(t.$t("community.authentication_view.audit_failed")),1)):(0,a.kq)("",!0)]),(0,a._)("img",{style:{"margin-top":"-22px"},src:g.lingSrc[1]},null,8,h),(0,a._)("div",null,[(0,a._)("div",{class:(0,s.C_)(2==u.status?"progress_number_active progress_number":"progress_number")},p,2),(0,a._)("div",null,(0,s.zw)(t.$t("community.authentication_view.audit_success")),1)])])),_:1}),(0,a.Wm)($,{class:"q-pb-none",style:{"font-size":"18px","font-weight":"500"}},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t.$t("community.authentication_view.equity"))+"：",1)])),_:1}),(0,a.Wm)($,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t.$t("community.authentication_view.equity_msg")),1)])),_:1}),(0,a.Wm)($,{class:"flex",style:{"align-items":"center"}},{default:(0,a.w5)((()=>[(0,a._)("div",f,(0,s.zw)(t.$t("community.authentication_view.real_name"))+"： ",1),u.submit_auth?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(S,{key:0,error:u.name_error,"error-message":u.name_error_tip,onBlur:e[0]||(e[0]=t=>g.ruleHandler("name")),modelValue:u.formData.name,"onUpdate:modelValue":e[1]||(e[1]=t=>u.formData.name=t),placeholder:this.$t("community.authentication_view.name_placeholder"),outlined:"",dense:"",class:"form_input",style:{"padding-bottom":"0 !important"}},null,8,["error","error-message","modelValue","placeholder"])),u.submit_auth?((0,a.wg)(),(0,a.iD)("div",b,(0,s.zw)(u.formData.name),1)):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)($,{class:"flex",style:{"align-items":"center"}},{default:(0,a.w5)((()=>[(0,a._)("div",v,(0,s.zw)(t.$t("community.authentication_view.id_number"))+"： ",1),u.submit_auth?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(S,{key:0,error:u.number_error,"error-message":u.number_error_tip,onBlur:e[2]||(e[2]=t=>g.ruleHandler("number")),modelValue:u.formData.number,"onUpdate:modelValue":e[3]||(e[3]=t=>u.formData.number=t),placeholder:this.$t("community.authentication_view.number_placeholder"),outlined:"",dense:"",class:"form_input",style:{"padding-bottom":"0 !important"}},null,8,["error","error-message","modelValue","placeholder"])),u.submit_auth?((0,a.wg)(),(0,a.iD)("div",w,(0,s.zw)(u.formData.number),1)):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)($,null,{default:(0,a.w5)((()=>[(0,a._)("div",y,[(0,a._)("div",k,(0,s.zw)(t.$t("community.authentication_view.id_photo"))+"： ",1),(0,a._)("div",null,[(0,a._)("div",x,[(0,a.Wm)(z,{onGetUploadImg:g.getUploadImg,class:"q-mr-lg",text:this.$t("community.authentication_view.front_photo"),imgSrc:u.imgSrcFront,side:"front",isSubmit:u.submit_auth},null,8,["onGetUploadImg","text","imgSrc","isSubmit"]),(0,a.Wm)(z,{onGetUploadImg:g.getUploadImg,text:this.$t("community.authentication_view.back_photo"),side:"back",imgSrc:u.imgSrcBack,isSubmit:u.submit_auth},null,8,["onGetUploadImg","text","imgSrc","isSubmit"])])])]),(0,a._)("div",D,(0,s.zw)(t.$t("community.authentication_view.photo_tip"))+"： ",1)])),_:1}),(0,a.Wm)($,{class:"q-mt-xl text-center",style:{"padding-bottom":"150px"}},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(q,{style:{"font-size":"18px","background-color":"#116fec","min-width":"220px",color:"white"},dense:"",onClick:g.submit,disable:u.disabled},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t.$t("community.authentication_view.submit")),1)])),_:1},8,["onClick","disable"]),[[r.F8,!u.submit_auth]]),(0,a.wy)((0,a.Wm)(q,{style:{"font-size":"18px","background-color":"#116fec",width:"220px",color:"white"},dense:"",onClick:g.reset},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t.$t("community.authentication_view.resubmit")),1)])),_:1},8,["onClick"]),[[r.F8,3==u.status]])])),_:1})])),_:1})])}i(5363);var S=i(5474);i(71);const z=t=>((0,a.dD)("data-v-0381d01d"),t=t(),(0,a.Cn)(),t),q={style:{width:"250px",height:"190px",border:"1px solid #d0d0d0","text-align":"center",position:"relative"}},C=z((()=>(0,a._)("img",{style:{margin:"55px 0 20px 0"},src:"statics/add_img.svg"},null,-1))),U={style:{"font-size":"16px",color:"#116fec"}},I=["src"];function W(t,e,i,r,n,o){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",q,[C,(0,a._)("div",U,(0,s.zw)(i.text),1),(0,a._)("input",{style:{position:"absolute",width:"100%",height:"100%",top:"0",left:"0",opacity:"0"},class:(0,s.C_)(i.isSubmit?"":"img_index"),onChange:e[0]||(e[0]=(...t)=>o.uploadImg&&o.uploadImg(...t)),type:"file"},null,34),n.img_src?((0,a.wg)(),(0,a.iD)("img",{key:0,style:{width:"100%",height:"100%",position:"absolute",top:"0",left:"0"},src:n.img_src},null,8,I)):(0,a.kq)("",!0)])])}const F={props:{text:"",side:"",imgSrc:"",isSubmit:""},data(){return{img_src:""}},watch:{imgSrc:{handler(t){t&&(this.img_src=t)}}},methods:{uploadImg(t){if(t.size>2097152)this.$q.notify({message:"图片大小超过2M，请重新上传",icon:"close",color:"negative"});else{let e=new FileReader;e.readAsDataURL(t.target.files[0]),setTimeout((()=>{this.img_src=e.result}),200),this.$emit("getUploadImg",this.side,t.target.files[0])}}}};var B=i(4260);const L=(0,B.Z)(F,[["render",W],["__scopeId","data-v-0381d01d"]]),Z=L;var V=i(51);const j={components:{UploadImg:Z},data(){return{formData:{name:"",number:"",file_front:"",file_back:""},status:"",disabled:!0,imgSrcFront:"",imgSrcBack:"",submit_auth:!1,name_error:!1,name_error_tip:this.$t("community.authentication_view.name_error"),number_error:!1,number_error_tip:this.$t("community.authentication_view.number_error")}},computed:{isFull(){return this.formData.name&&this.formData.number&&this.formData.file_front&&this.formData.file_back&&!this.name_error&&!this.number_error},lingSrc(){return 0==this.status?["statics/line.svg","statics/greyLine.svg"]:1==this.status?["statics/blueLine.svg","statics/line.svg"]:2==this.status?["statics/blueLine.svg","statics/blueLine.svg"]:["statics/blueLine.svg","statics/greyLine.svg"]}},watch:{isFull(t){this.disabled=!t},formData:{handler(t){this.formData.name=t.name.replace(/\s/g,""),this.formData.number=t.number.replace(/\s/g,"")},deep:!0}},methods:{ruleHandler(t){"number"==t?0==/(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(this.formData.number)?this.number_error=!0:this.number_error=!1:-1==this.formData.name.search(/[0-9]/g)&&this.formData.name?this.name_error=!1:this.name_error=!0},getUploadImg(t,e){"front"==t?this.formData.file_front=e:this.formData.file_back=e},submit(){let t=new FormData;t.append("email",(0,V.Z)(this.$q.cookies.get("token")).email),t.append("name",this.formData.name),t.append("id_number",this.formData.number),t.append("the_front_of_id_card",this.formData.file_front),t.append("reverse_side_of_id_card",this.formData.file_back),(0,S.postauth)("user/api/v1/auth/",t).then((t=>{this.$router.go(0)}))},getAuthStatus(){(0,S.getauth)("user/api/v1/auth/").then((t=>{let e=t[t.length-1];e?(this.formData.name=e.name,this.formData.number=e.id_number,this.imgSrcFront=e.the_front_of_id_card,this.imgSrcBack=e.reverse_side_of_id_card,this.status=e.verify_status,this.submit_auth=!0):this.submit_auth=!1}))},reset(){this.imgSrcFront=" ",this.imgSrcBack=" ",this.status=0,this.submit_auth=!1,this.formData={name:"",number:"",file_front:"",file_back:""}}},created(){this.getAuthStatus(),this.$store.dispatch("bbsChange/isIndexMenu",!1),this.$store.dispatch("bbsChange/link","verified")}};var G=i(151),Q=i(5589),A=i(4842),H=i(2165),M=i(7518),R=i.n(M);const T=(0,B.Z)(j,[["render",$],["__scopeId","data-v-4eaf76bf"]]),X=T;R()(j,"components",{QCard:G.Z,QCardSection:Q.Z,QInput:A.Z,QBtn:H.Z})}}]);